<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logo Playground - Recursive.eco</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="../public/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../assets/css/components.css">
    
    <style>
        /* Animation keyframes for the playground */
        @keyframes breathe {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        
        .control-section {
            background: #f8fafc;
            border-left: 4px solid #9333ea;
        }
        
        .preview-container {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .preview-container:hover {
            border-color: #9333ea;
            box-shadow: 0 4px 12px rgba(147, 51, 234, 0.15);
        }
    </style>
</head>

<body class="bg-white">
    <!-- Load inline component system -->
    <script src="../assets/js/components/site-shell-inline.js"></script>
    
    <!-- Spiral Header Component -->
    <spiral-header></spiral-header>
    
    <!-- Load spiral generation functions FIRST before any code that uses them -->
    <script src="spiral.js"></script>

    <div class="container mx-auto px-6 py-8">
        <!-- Title Section -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">Spiral Logo Playground</h1>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                Interactive environment for testing spiral parameters and animations. Experiment with different settings to find your perfect logo configuration.
            </p>
        </div>

        <!-- Main Preview -->
        <div class="mb-8">
            <h2 class="text-2xl font-semibold text-gray-900 mb-4">Live Preview</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <!-- Static Preview -->
                <div class="text-center">
                    <h3 class="text-lg font-medium text-gray-700 mb-3">Static Preview</h3>
                    <div id="spiral-preview-static" class="preview-container w-64 h-64 flex items-center justify-center mx-auto">
                        <!-- Static spiral will be inserted here -->
                    </div>
                    <p class="text-sm text-gray-500 mt-2">No animation - pure design</p>
                </div>
                
                <!-- Animated Preview -->
                <div class="text-center">
                    <h3 class="text-lg font-medium text-gray-700 mb-3">Animated Preview</h3>
                    <div id="spiral-preview-animated" class="preview-container w-64 h-64 flex items-center justify-center mx-auto">
                        <!-- Animated spiral will be inserted here -->
                    </div>
                    <div class="flex justify-center space-x-3 mt-4">
                        <button id="pause-btn" onclick="toggleAnimation()" 
                                class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2">
                            <span id="pause-icon">‚è∏Ô∏è</span>
                            <span id="pause-text">Pause</span>
                        </button>
                        <button onclick="resetAnimation()" 
                                class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                            üîÑ Reset
                        </button>
                    </div>
                    <p class="text-sm text-gray-500 mt-2">Live animation preview</p>
                </div>
            </div>
        </div>

        <!-- Controls Grid -->
        <div class="grid lg:grid-cols-2 gap-8">
            <!-- Left Column: Geometry Controls -->
            <div class="control-section p-6 rounded-lg">
                <h3 class="text-xl font-semibold text-gray-900 mb-6">Spiral Geometry</h3>
                
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Size</label>
                        <input type="range" id="size" min="50" max="300" value="100" 
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>50px</span>
                            <span id="size-value" class="font-medium text-purple-600">100px</span>
                            <span>300px</span>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Turns</label>
                        <input type="range" id="turns" min="2" max="12" value="6"
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>2</span>
                            <span id="turns-value" class="font-medium text-purple-600">6</span>
                            <span>12</span>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Growth Rate</label>
                        <select id="growth-rate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-black">
                            <option value="golden">Golden Ratio (Recommended)</option>
                            <option value="linear">Linear</option>
                            <option value="exponential">Exponential</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Start Radius</label>
                        <input type="range" id="start-radius" min="0.1" max="5" step="0.1" value="0.5"
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>0.1</span>
                            <span id="start-radius-value" class="font-medium text-purple-600">0.5</span>
                            <span>5.0</span>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Max Radius (%)</label>
                        <input type="range" id="max-radius" min="20" max="50" value="45"
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>20%</span>
                            <span id="max-radius-value" class="font-medium text-purple-600">45%</span>
                            <span>50%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Styling & Animation Controls -->
            <div class="control-section p-6 rounded-lg">
                <h3 class="text-xl font-semibold text-gray-900 mb-6">Styling & Animation</h3>
                
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Color</label>
                        <div class="flex items-center space-x-3">
                            <input type="color" id="color" value="#9333ea" 
                                   class="w-12 h-12 border border-gray-300 rounded-lg cursor-pointer">
                            <span id="color-value" class="text-sm font-medium text-gray-700">#9333ea</span>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Stroke Width</label>
                        <input type="range" id="stroke-width" min="0.2" max="3" step="0.1" value="0.8"
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>0.2</span>
                            <span id="stroke-width-value" class="font-medium text-purple-600">0.8</span>
                            <span>3.0</span>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Opacity</label>
                        <input type="range" id="opacity" min="0.3" max="1" step="0.1" value="0.8"
                               class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                        <div class="flex justify-between text-sm text-gray-500 mt-1">
                            <span>0.3</span>
                            <span id="opacity-value" class="font-medium text-purple-600">0.8</span>
                            <span>1.0</span>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Rhythm Preset</label>
                        <select id="rhythm-preset" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-black">
                            <option value="simple" selected>Simple (12s breathe + draw)</option>
                            <option value="irrational">Irrational (30s:45s:20s:60s rhythms)</option>
                            <option value="fast">Fast (8s:12s:6s:20s rhythms)</option>
                            <option value="custom">Custom (manual controls)</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-2">Irrational rhythms create organic, non-repetitive patterns</p>
                    </div>

                    <div id="custom-controls" class="space-y-4 hidden">
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="enable-rotation" class="rounded">
                                <span class="text-sm font-medium text-gray-700">Enable Rotation</span>
                            </label>
                        </div>
                        
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="enable-pulse" class="rounded">
                                <span class="text-sm font-medium text-gray-700">Enable Pulse</span>
                            </label>
                        </div>
                        
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="enable-fade" class="rounded">
                                <span class="text-sm font-medium text-gray-700">Enable Fade (Transparency)</span>
                            </label>
                        </div>
                        
                        <div>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="enable-stroke-vary" class="rounded">
                                <span class="text-sm font-medium text-gray-700">Enable Stroke Variation</span>
                            </label>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Breathe Duration</label>
                            <input type="range" id="breathe-duration" min="5000" max="60000" step="1000" value="12000"
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                            <div class="flex justify-between text-sm text-gray-500 mt-1">
                                <span>5s</span>
                                <span id="breathe-duration-value" class="font-medium text-purple-600">12s</span>
                                <span>60s</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Draw Duration</label>
                            <input type="range" id="draw-duration" min="5000" max="90000" step="1000" value="12000"
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                            <div class="flex justify-between text-sm text-gray-500 mt-1">
                                <span>5s</span>
                                <span id="draw-duration-value" class="font-medium text-purple-600">12s</span>
                                <span>90s</span>
                            </div>
                        </div>
                        
                        <div id="rotation-controls" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Rotation Duration</label>
                            <input type="range" id="rotation-duration" min="10000" max="120000" step="5000" value="60000"
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                            <div class="flex justify-between text-sm text-gray-500 mt-1">
                                <span>10s</span>
                                <span id="rotation-duration-value" class="font-medium text-purple-600">60s</span>
                                <span>120s</span>
                            </div>
                        </div>
                        
                        <div id="pulse-controls" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Pulse Duration</label>
                            <input type="range" id="pulse-duration" min="3000" max="60000" step="1000" value="20000"
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                            <div class="flex justify-between text-sm text-gray-500 mt-1">
                                <span>3s</span>
                                <span id="pulse-duration-value" class="font-medium text-purple-600">20s</span>
                                <span>60s</span>
                            </div>
                        </div>
                        
                        <div id="fade-controls" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fade Duration</label>
                            <input type="range" id="fade-duration" min="5000" max="60000" step="1000" value="25000"
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                            <div class="flex justify-between text-sm text-gray-500 mt-1">
                                <span>5s</span>
                                <span id="fade-duration-value" class="font-medium text-purple-600">25s</span>
                                <span>60s</span>
                            </div>
                        </div>
                        
                        <div id="stroke-vary-controls" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Stroke Variation Duration</label>
                            <input type="range" id="stroke-vary-duration" min="10000" max="90000" step="2000" value="35000"
                                   class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                            <div class="flex justify-between text-sm text-gray-500 mt-1">
                                <span>10s</span>
                                <span id="stroke-vary-duration-value" class="font-medium text-purple-600">35s</span>
                                <span>90s</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Size Tests -->
        <div class="mt-8">
            <h3 class="text-xl font-semibold text-gray-900 mb-4">Size Tests</h3>
            <div class="flex flex-wrap gap-8 justify-center">
                <div class="text-center">
                    <h4 class="text-sm font-medium text-gray-700 mb-2">Small (50x50)</h4>
                    <div id="test-small" class="preview-container w-12 h-12 flex items-center justify-center mx-auto"></div>
                </div>
                <div class="text-center">
                    <h4 class="text-sm font-medium text-gray-700 mb-2">Medium (100x100)</h4>
                    <div id="test-medium" class="preview-container w-24 h-24 flex items-center justify-center mx-auto"></div>
                </div>
                <div class="text-center">
                    <h4 class="text-sm font-medium text-gray-700 mb-2">Large (200x200)</h4>
                    <div id="test-large" class="preview-container w-48 h-48 flex items-center justify-center mx-auto"></div>
                </div>
            </div>
        </div>

        <!-- Export Configuration -->
        <div class="mt-8">
            <h3 class="text-xl font-semibold text-gray-900 mb-4">Export Configuration</h3>
            <div class="bg-gray-50 p-6 rounded-lg">
                <textarea id="config-export" rows="8" 
                         class="w-full p-4 font-mono text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-black bg-white" 
                         readonly></textarea>
                <div class="flex space-x-4 mt-4">
                    <button onclick="copyConfig()" 
                            class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                        Copy Configuration
                    </button>
                    <button onclick="resetToDefaults()" 
                            class="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                        Reset to Defaults
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-50 border-t border-gray-200 mt-16">
        <div class="container mx-auto px-6 py-8">
            <div class="text-center text-gray-600">
                <p>&copy; 2025 Recursive.eco. Logo Playground for spiral parameter testing.</p>
            </div>
        </div>
    </footer>
    
    <script>
        // Use the actual spiral generator from spiral.js, but extend it for configurability
        function generateConfigurableSpiralPath(config = {}) {
            const {
                size = 100,
                turns = 6,
                growthRate = 'golden',
                startRadius = 0.5,
                maxRadius = 45, // percentage
                precision = 300,
                direction = 'outward'
            } = config;

            const centerX = size / 2;
            const centerY = size / 2;
            const maxR = size * (maxRadius / 100);
            const points = [];

            // Calculate growth rate based on type
            let growth;
            switch (growthRate) {
                case 'golden':
                    const goldenRatio = (1 + Math.sqrt(5)) / 2;
                    growth = Math.log(goldenRatio) / (Math.PI / 2);
                    break;
                case 'linear':
                    growth = 0.3;
                    break;
                case 'exponential':
                    growth = 0.8;
                    break;
                default:
                    growth = Math.log((1 + Math.sqrt(5)) / 2) / (Math.PI / 2);
            }

            if (direction === 'inward') growth = -growth;

            const totalPoints = turns * precision;

            for (let i = 0; i <= totalPoints; i++) {
                const t = (i / precision) * 2 * Math.PI;
                let r = startRadius * Math.exp(growth * t);

                if (r > maxR) r = maxR;

                const x = centerX + r * Math.cos(t);
                const y = centerY + r * Math.sin(t);

                points.push(`${i === 0 ? 'M' : 'L'} ${x.toFixed(2)} ${y.toFixed(2)}`);
            }

            return points.join(' ');
        }

        // Create spiral using the new rhythm system
        function createSpiralSVG(container, config, style = {}, rhythmSettings = {}) {
            const { preset = 'simple', customRhythms = {}, enableRotation = false, enablePulse = false, enableFade = false, enableStrokeVary = false } = rhythmSettings;
            
            if (preset === 'custom') {
                // Use custom rhythm settings
                return createSpiral(container, {
                    size: config.size,
                    turns: config.turns,
                    color: style.color || '#9333ea',
                    strokeWidth: style.strokeWidth || '0.8',
                    opacity: style.opacity || '0.8',
                    rhythms: customRhythms,
                    enableRotation,
                    enablePulse,
                    enableFade,
                    enableStrokeVary,
                    animated: true
                });
            } else {
                // Use preset rhythms
                return createSpiralWithRhythm(container, preset, {
                    size: config.size,
                    turns: config.turns,
                    color: style.color || '#9333ea',
                    strokeWidth: style.strokeWidth || '0.8',
                    opacity: style.opacity || '0.8'
                });
            }
        }
        
        // Create static spiral
        function createStaticSpiralSVG(container, config, style = {}) {
            return createSpiral(container, {
                size: config.size,
                turns: config.turns,
                color: style.color || '#9333ea',
                strokeWidth: style.strokeWidth || '0.8',
                opacity: style.opacity || '0.8',
                animated: false
            });
        }

        // Ensure breathing animation is applied (same approach as spiral.js)
        function ensureBreathingAnimation(element, duration = 12000) {
            const durationSec = duration / 1000;
            const uniqueId = 'playground-breathe-' + Date.now();
            
            if (!document.getElementById(uniqueId)) {
                const style = document.createElement('style');
                style.id = uniqueId;
                style.textContent = `
                    @keyframes breathe {
                        0%, 100% { 
                            transform: scale(1);
                            opacity: 0.8;
                        }
                        50% { 
                            transform: scale(1.05);
                            opacity: 1;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
            
            element.style.animation = `breathe ${durationSec}s ease-in-out infinite`;
        }

        // Apply animation styles
        function applyAnimation(element, type, duration) {
            const durationSec = duration / 1000;

            switch (type) {
                case 'breathe':
                    element.style.animation = `breathe ${durationSec}s ease-in-out infinite`;
                    break;
                case 'rotate':
                    element.style.animation = `rotate ${durationSec}s linear infinite`;
                    break;
                case 'pulse':
                    element.style.animation = `pulse ${durationSec}s ease-in-out infinite`;
                    break;
            }
        }

        // Get current configuration from inputs
        function getCurrentConfig() {
            return {
                size: parseInt(document.getElementById('size').value),
                turns: parseInt(document.getElementById('turns').value),
                growthRate: document.getElementById('growth-rate').value,
                startRadius: parseFloat(document.getElementById('start-radius').value),
                maxRadius: parseInt(document.getElementById('max-radius').value),
                precision: 300
            };
        }

        function getCurrentStyle() {
            return {
                color: document.getElementById('color').value,
                strokeWidth: parseFloat(document.getElementById('stroke-width').value),
                opacity: parseFloat(document.getElementById('opacity').value)
            };
        }
        
        function getCurrentRhythmSettings() {
            const preset = document.getElementById('rhythm-preset').value;
            
            if (preset === 'custom') {
                const customRhythms = {
                    breathe: { duration: parseInt(document.getElementById('breathe-duration').value), timing: 'ease-in-out' },
                    draw: { duration: parseInt(document.getElementById('draw-duration').value), timing: 'ease-in-out' }
                };
                
                const enableRotation = document.getElementById('enable-rotation').checked;
                const enablePulse = document.getElementById('enable-pulse').checked;
                const enableFade = document.getElementById('enable-fade').checked;
                const enableStrokeVary = document.getElementById('enable-stroke-vary').checked;
                
                if (enableRotation) {
                    customRhythms.rotate = { duration: parseInt(document.getElementById('rotation-duration').value), timing: 'ease-in-out' };
                }
                
                if (enablePulse) {
                    customRhythms.pulse = { duration: parseInt(document.getElementById('pulse-duration').value), timing: 'ease-in-out' };
                }
                
                if (enableFade) {
                    customRhythms.fade = { duration: parseInt(document.getElementById('fade-duration').value), timing: 'ease-in-out' };
                }
                
                if (enableStrokeVary) {
                    customRhythms.strokeVary = { duration: parseInt(document.getElementById('stroke-vary-duration').value), timing: 'ease-in-out' };
                }
                
                return {
                    preset: 'custom',
                    customRhythms,
                    enableRotation,
                    enablePulse,
                    enableFade,
                    enableStrokeVary
                };
            }
            
            return { preset };
        }

        // Store animated SVG reference for control
        let animatedSVG = null;
        let isAnimationPaused = false;

        // Update preview
        function updatePreview() {
            const config = getCurrentConfig();
            const style = getCurrentStyle();
            const rhythmSettings = getCurrentRhythmSettings();

            // Update value displays
            document.getElementById('size-value').textContent = config.size + 'px';
            document.getElementById('turns-value').textContent = config.turns;
            document.getElementById('start-radius-value').textContent = config.startRadius;
            document.getElementById('max-radius-value').textContent = config.maxRadius + '%';
            document.getElementById('stroke-width-value').textContent = style.strokeWidth;
            document.getElementById('opacity-value').textContent = style.opacity;
            document.getElementById('color-value').textContent = style.color;

            // Update custom rhythm value displays if in custom mode
            if (rhythmSettings.preset === 'custom') {
                document.getElementById('breathe-duration-value').textContent = (rhythmSettings.customRhythms.breathe.duration / 1000) + 's';
                document.getElementById('draw-duration-value').textContent = (rhythmSettings.customRhythms.draw.duration / 1000) + 's';
                
                if (rhythmSettings.enableRotation) {
                    document.getElementById('rotation-duration-value').textContent = (rhythmSettings.customRhythms.rotate.duration / 1000) + 's';
                }
                
                if (rhythmSettings.enablePulse) {
                    document.getElementById('pulse-duration-value').textContent = (rhythmSettings.customRhythms.pulse.duration / 1000) + 's';
                }
                
                if (rhythmSettings.enableFade) {
                    document.getElementById('fade-duration-value').textContent = (rhythmSettings.customRhythms.fade.duration / 1000) + 's';
                }
                
                if (rhythmSettings.enableStrokeVary) {
                    document.getElementById('stroke-vary-duration-value').textContent = (rhythmSettings.customRhythms.strokeVary.duration / 1000) + 's';
                }
            }

            // Update static preview (no animation)
            createStaticSpiralSVG(document.getElementById('spiral-preview-static'), config, style);

            // Update animated preview
            animatedSVG = createSpiralSVG(document.getElementById('spiral-preview-animated'), config, style, rhythmSettings);
            
            // Restore pause state if needed
            if (isAnimationPaused) {
                pauseAnimation();
            }

            // Update test sizes (static)
            createSpiralSVG(document.getElementById('test-small'), {...config, size: 50}, style, false);
            createSpiralSVG(document.getElementById('test-medium'), {...config, size: 100}, style, false);
            createSpiralSVG(document.getElementById('test-large'), {...config, size: 200}, style, false);

            // Update export
            updateExport();
        }

        // Animation control functions
        function toggleAnimation() {
            if (isAnimationPaused) {
                resumeAnimation();
            } else {
                pauseAnimation();
            }
        }

        function pauseAnimation() {
            if (animatedSVG) {
                animatedSVG.style.animationPlayState = 'paused';
                isAnimationPaused = true;
                document.getElementById('pause-icon').textContent = '‚ñ∂Ô∏è';
                document.getElementById('pause-text').textContent = 'Resume';
            }
        }

        function resumeAnimation() {
            if (animatedSVG) {
                animatedSVG.style.animationPlayState = 'running';
                isAnimationPaused = false;
                document.getElementById('pause-icon').textContent = '‚è∏Ô∏è';
                document.getElementById('pause-text').textContent = 'Pause';
            }
        }

        function resetAnimation() {
            if (animatedSVG) {
                // Force restart animation by removing and re-adding
                const parent = animatedSVG.parentNode;
                const config = getCurrentConfig();
                const style = getCurrentStyle();
                
                animatedSVG = createSpiralSVG(parent, config, style, true);
                isAnimationPaused = false;
                document.getElementById('pause-icon').textContent = '‚è∏Ô∏è';
                document.getElementById('pause-text').textContent = 'Pause';
            }
        }

        // Update export configuration
        function updateExport() {
            const config = getCurrentConfig();
            const style = getCurrentStyle();

            const exportConfig = {
                spiral: config,
                style: style,
                usage: {
                    javascript: `// Use this configuration in your spiral generator\nconst spiralConfig = ${JSON.stringify(config, null, 2)};\nconst styleConfig = ${JSON.stringify(style, null, 2)};`,
                    svgPath: generateSpiralPath(config)
                }
            };

            document.getElementById('config-export').value = JSON.stringify(exportConfig, null, 2);
        }

        // Copy configuration to clipboard
        function copyConfig() {
            const textarea = document.getElementById('config-export');
            textarea.select();
            document.execCommand('copy');
            
            // Show feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            button.style.backgroundColor = '#059669';
            setTimeout(() => {
                button.textContent = originalText;
                button.style.backgroundColor = '';
            }, 2000);
        }

        // Handle rhythm preset changes
        function handleRhythmPresetChange() {
            const preset = document.getElementById('rhythm-preset').value;
            const customControls = document.getElementById('custom-controls');
            
            if (preset === 'custom') {
                customControls.classList.remove('hidden');
            } else {
                customControls.classList.add('hidden');
            }
            
            updatePreview();
        }
        
        // Handle custom rhythm toggles
        function handleCustomToggles() {
            const enableRotation = document.getElementById('enable-rotation').checked;
            const enablePulse = document.getElementById('enable-pulse').checked;
            const enableFade = document.getElementById('enable-fade').checked;
            const enableStrokeVary = document.getElementById('enable-stroke-vary').checked;
            
            const rotationControls = document.getElementById('rotation-controls');
            const pulseControls = document.getElementById('pulse-controls');
            const fadeControls = document.getElementById('fade-controls');
            const strokeVaryControls = document.getElementById('stroke-vary-controls');
            
            if (enableRotation) {
                rotationControls.classList.remove('hidden');
            } else {
                rotationControls.classList.add('hidden');
            }
            
            if (enablePulse) {
                pulseControls.classList.remove('hidden');
            } else {
                pulseControls.classList.add('hidden');
            }
            
            if (enableFade) {
                fadeControls.classList.remove('hidden');
            } else {
                fadeControls.classList.add('hidden');
            }
            
            if (enableStrokeVary) {
                strokeVaryControls.classList.remove('hidden');
            } else {
                strokeVaryControls.classList.add('hidden');
            }
            
            updatePreview();
        }

        // Reset to default values
        function resetToDefaults() {
            document.getElementById('size').value = 100;
            document.getElementById('turns').value = 6;
            document.getElementById('growth-rate').value = 'golden';
            document.getElementById('start-radius').value = 0.5;
            document.getElementById('max-radius').value = 45;
            document.getElementById('color').value = '#9333ea';
            document.getElementById('stroke-width').value = 0.8;
            document.getElementById('opacity').value = 0.8;
            document.getElementById('rhythm-preset').value = 'simple';
            document.getElementById('custom-controls').classList.add('hidden');
            document.getElementById('enable-rotation').checked = false;
            document.getElementById('enable-pulse').checked = false;
            document.getElementById('enable-fade').checked = false;
            document.getElementById('enable-stroke-vary').checked = false;
            document.getElementById('breathe-duration').value = 12000;
            document.getElementById('draw-duration').value = 12000;
            document.getElementById('rotation-duration').value = 60000;
            document.getElementById('pulse-duration').value = 20000;
            document.getElementById('fade-duration').value = 25000;
            document.getElementById('stroke-vary-duration').value = 35000;
            updatePreview();
        }

        // Add event listeners
        document.querySelectorAll('input, select').forEach(input => {
            input.addEventListener('input', updatePreview);
            input.addEventListener('change', updatePreview);
        });

        // Add specific rhythm control listeners
        document.getElementById('rhythm-preset').addEventListener('change', handleRhythmPresetChange);
        document.getElementById('enable-rotation').addEventListener('change', handleCustomToggles);
        document.getElementById('enable-pulse').addEventListener('change', handleCustomToggles);
        document.getElementById('enable-fade').addEventListener('change', handleCustomToggles);
        document.getElementById('enable-stroke-vary').addEventListener('change', handleCustomToggles);

        // Initial preview
        updatePreview();
    </script>
</body>
</html>